<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ûï Ingredientes - Dieta Gracie</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="max-w-7xl mx-auto px-2 sm:px-4 py-4 sm:py-8">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow mb-4 sm:mb-6">
            <div class="flex flex-wrap border-b overflow-x-auto">
                <a href="dashboard.html" class="px-3 sm:px-6 py-3 sm:py-4 flex items-center gap-1 sm:gap-2 text-gray-600 hover:text-gray-800 text-sm sm:text-base whitespace-nowrap">
                    üìä Dashboard
                </a>
                <a href="ingredientes.html" class="px-3 sm:px-6 py-3 sm:py-4 flex items-center gap-1 sm:gap-2 border-b-2 border-blue-600 text-blue-600 bg-blue-50 text-sm sm:text-base whitespace-nowrap">
                    ‚ûï Ingredientes
                </a>
                <a href="refeicoes.html" class="px-3 sm:px-6 py-3 sm:py-4 flex items-center gap-1 sm:gap-2 text-gray-600 hover:text-gray-800 text-sm sm:text-base whitespace-nowrap">
                    üéØ Refei√ß√µes
                </a>
                <a href="receitas.html" class="px-3 sm:px-6 py-3 sm:py-4 flex items-center gap-1 sm:gap-2 text-gray-600 hover:text-gray-800 text-sm sm:text-base whitespace-nowrap">
                    üë®‚Äçüç≥ Receitas
                </a>
                <a href="historico.html" class="px-3 sm:px-6 py-3 sm:py-4 flex items-center gap-1 sm:gap-2 text-gray-600 hover:text-gray-800 text-sm sm:text-base whitespace-nowrap">
                    üìÖ Hist√≥rico
                </a>
            </div>
        </div>

        <!-- Content -->
        <div class="space-y-4 sm:space-y-6">
            <!-- Informa√ß√£o sobre Insumos -->
            <div class="bg-blue-50 border border-blue-200 p-4 sm:p-6 rounded-lg">
                <h3 class="text-lg sm:text-xl font-semibold text-blue-800 mb-2">üìã Banco de Ingredientes</h3>
                <p class="text-blue-700 text-sm sm:text-base mb-3">
                    Esta p√°gina exibe todos os ingredientes dispon√≠veis para suas refei√ß√µes. Os dados s√£o baseados no arquivo <strong>Insumos.csv</strong> do projeto.
                </p>
                <div class="bg-white p-3 sm:p-4 rounded border border-blue-200">
                    <h4 class="font-semibold text-blue-800 mb-2 text-sm sm:text-base">üí° Como adicionar novos ingredientes:</h4>
                    <ol class="text-blue-700 text-xs sm:text-sm space-y-1">
                        <li>1. Abra o arquivo <code class="bg-blue-100 px-1 rounded">Insumos.csv</code> no projeto</li>
                        <li>2. Adicione uma nova linha com os dados do ingrediente</li>
                        <li>3. Salve o arquivo e atualize esta p√°gina</li>
                        <li>4. O novo ingrediente aparecer√° automaticamente na lista</li>
                    </ol>
                </div>
            </div>

            <!-- Banco de Ingredientes -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <h3 class="text-base sm:text-lg font-semibold p-4 sm:p-6 border-b">üçΩÔ∏è Lista de Ingredientes Dispon√≠veis</h3>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm">Nome</th>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm">Categoria</th>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">Calorias</th>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">Prote√≠na</th>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">Carbs</th>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">Gordura</th>
                                <th class="px-2 sm:px-4 py-2 sm:py-3 text-center text-xs sm:text-sm">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tabela-ingredientes" class="divide-y">
                            <!-- Ingredientes ser√£o inseridos aqui via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dados padr√£o dos ingredientes (baseados no Insumos.csv)
        const ingredientesPadrao = [
            { id: 1, name: 'Peito de Frango', category: 'Prote√≠na', calories: 165, protein: 31, carbs: 0, fat: 3.6, fiber: 0 },
            { id: 2, name: 'F√≠gado Bovino', category: 'Prote√≠na', calories: 135, protein: 20, carbs: 3.9, fat: 3.6, fiber: 0 },
            { id: 3, name: 'Contra-Fil√©', category: 'Prote√≠na', calories: 250, protein: 26, carbs: 0, fat: 15, fiber: 0 },
            { id: 4, name: 'Quinoa Gr√£o Mix', category: 'Carboidrato', calories: 120, protein: 4.4, carbs: 21.3, fat: 1.9, fiber: 2.8 },
            { id: 5, name: 'Aveia em Flocos', category: 'Carboidrato', calories: 389, protein: 16.9, carbs: 66, fat: 6.9, fiber: 10.6 },
            { id: 6, name: 'Farelo de Aveia', category: 'Carboidrato', calories: 246, protein: 17.3, carbs: 66, fat: 7, fiber: 15.4 },
            { id: 7, name: 'Nozes', category: 'Gordura', calories: 654, protein: 15, carbs: 14, fat: 65, fiber: 6.7 },
            { id: 8, name: 'Amendoim Torrado', category: 'Gordura', calories: 567, protein: 25.8, carbs: 16, fat: 49, fiber: 8.5 },
            { id: 9, name: 'Farinha de Aveia', category: 'Carboidrato', calories: 389, protein: 16.9, carbs: 66, fat: 6.9, fiber: 10.6 },
            { id: 10, name: 'Quinoa Urbano', category: 'Carboidrato', calories: 120, protein: 4.4, carbs: 21.3, fat: 1.9, fiber: 2.8 },
            { id: 11, name: 'Ovos', category: 'Prote√≠na', calories: 155, protein: 13, carbs: 1.1, fat: 11, fiber: 0 },
            { id: 12, name: 'Castanha do Par√°', category: 'Gordura', calories: 656, protein: 14, carbs: 12, fat: 66, fiber: 7.5 },
            { id: 13, name: 'Amendoim Cru', category: 'Gordura', calories: 567, protein: 25.8, carbs: 16, fat: 49, fiber: 8.5 },
            { id: 14, name: 'Sardinha', category: 'Prote√≠na', calories: 208, protein: 24, carbs: 0, fat: 12, fiber: 0 },
            { id: 15, name: 'Atum', category: 'Prote√≠na', calories: 144, protein: 30, carbs: 0, fat: 1, fiber: 0 },
            { id: 16, name: 'Batata Doce', category: 'Carboidrato', calories: 86, protein: 1.6, carbs: 20, fat: 0.1, fiber: 3 },
            { id: 17, name: 'Batata Doce Roxa', category: 'Carboidrato', calories: 86, protein: 1.6, carbs: 20, fat: 0.1, fiber: 3 },
            { id: 18, name: 'Cenoura', category: 'Vegetal', calories: 41, protein: 0.9, carbs: 10, fat: 0.2, fiber: 2.8 },
            { id: 19, name: 'Abacate', category: 'Gordura', calories: 160, protein: 2, carbs: 8.5, fat: 15, fiber: 6.7 },
            { id: 20, name: 'Br√≥colis', category: 'Vegetal', calories: 34, protein: 2.8, carbs: 7, fat: 0.4, fiber: 2.6 },
            { id: 21, name: 'Couve Flor', category: 'Vegetal', calories: 25, protein: 1.9, carbs: 5, fat: 0.3, fiber: 2 },
            { id: 22, name: 'A√ßa√≠', category: 'Fruta', calories: 70, protein: 4, carbs: 4, fat: 5, fiber: 2.5 },
            { id: 23, name: 'Arroz Branco', category: 'Carboidrato', calories: 130, protein: 2.7, carbs: 28, fat: 0.3, fiber: 0.4 },
            { id: 24, name: 'Banana', category: 'Fruta', calories: 89, protein: 1.1, carbs: 23, fat: 0.3, fiber: 2.6 }
        ];

        // Carregar ingredientes do localStorage ou usar padr√£o
        function carregarIngredientes() {
            const ingredientes = JSON.parse(localStorage.getItem('ingredientes') || JSON.stringify(ingredientesPadrao));
            return ingredientes;
        }

        // Salvar ingredientes no localStorage
        function salvarIngredientes(ingredientes) {
            localStorage.setItem('ingredientes', JSON.stringify(ingredientes));
        }

        // Renderizar tabela de ingredientes
        function renderizarTabela() {
            const ingredientes = carregarIngredientes();
            const tbody = document.getElementById('tabela-ingredientes');
            
            tbody.innerHTML = ingredientes.map(ingrediente => `
                <tr class="hover:bg-gray-50">
                    <td class="px-2 sm:px-4 py-2 sm:py-3 font-medium text-xs sm:text-sm">${ingrediente.name}</td>
                    <td class="px-2 sm:px-4 py-2 sm:py-3">
                        <span class="px-1 sm:px-2 py-1 rounded-full text-xs ${getCategoriaClass(ingrediente.category)}">
                            ${ingrediente.category}
                        </span>
                    </td>
                    <td class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">${ingrediente.calories}</td>
                    <td class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">${ingrediente.protein}g</td>
                    <td class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">${ingrediente.carbs}g</td>
                    <td class="px-2 sm:px-4 py-2 sm:py-3 text-right text-xs sm:text-sm">${ingrediente.fat}g</td>
                    <td class="px-2 sm:px-4 py-2 sm:py-3 text-center">
                        <div class="flex justify-center gap-1 sm:gap-2">
                            <button
                                onclick="adicionarARefeicao(${ingrediente.id})"
                                class="text-blue-600 hover:text-blue-800 text-sm sm:text-base"
                                title="Adicionar √† refei√ß√£o"
                            >
                                ‚ûï
                            </button>
                            <button
                                onclick="editarIngrediente(${ingrediente.id})"
                                class="text-green-600 hover:text-green-800 text-sm sm:text-base"
                                title="Editar ingrediente"
                            >
                                ‚úèÔ∏è
                            </button>
                            <button
                                onclick="excluirIngrediente(${ingrediente.id})"
                                class="text-red-600 hover:text-red-800 text-sm sm:text-base"
                                title="Excluir ingrediente"
                            >
                                üóëÔ∏è
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // Obter classe CSS para categoria
        function getCategoriaClass(categoria) {
            const classes = {
                'Prote√≠na': 'bg-red-100 text-red-700',
                'Carboidrato': 'bg-green-100 text-green-700',
                'Gordura': 'bg-yellow-100 text-yellow-700',
                'Fruta': 'bg-orange-100 text-orange-700',
                'Vegetal': 'bg-green-100 text-green-700',
                'L√≠quido': 'bg-blue-100 text-blue-700'
            };
            return classes[categoria] || 'bg-gray-100 text-gray-700';
        }

        // Adicionar ingrediente √† refei√ß√£o
        function adicionarARefeicao(ingredienteId) {
            const ingredientes = carregarIngredientes();
            const ingrediente = ingredientes.find(i => i.id === ingredienteId);
            
            if (ingrediente) {
                // Salvar no localStorage para usar na p√°gina de refei√ß√µes
                const refeicaoAtual = JSON.parse(localStorage.getItem('refeicaoAtual') || '[]');
                refeicaoAtual.push({
                    ingrediente: ingrediente,
                    quantidade: 100
                });
                localStorage.setItem('refeicaoAtual', JSON.stringify(refeicaoAtual));
                
                alert(`${ingrediente.name} adicionado √† refei√ß√£o atual!`);
            }
        }
        
        // Modal de Edi√ß√£o
        let ingredienteEditando = null;

        function editarIngrediente(id) {
            const ingredientes = carregarIngredientes();
            const ingrediente = ingredientes.find(i => i.id === id);
            
            if (ingrediente) {
                ingredienteEditando = ingrediente;
                preencherModalEdicao(ingrediente);
                document.getElementById('modal-edicao').classList.remove('hidden');
            }
        }

        function preencherModalEdicao(ingrediente) {
            document.getElementById('edit-nome').value = ingrediente.name;
            document.getElementById('edit-categoria').value = ingrediente.category;
            document.getElementById('edit-calorias').value = ingrediente.calories;
            document.getElementById('edit-proteina').value = ingrediente.protein;
            document.getElementById('edit-carbs').value = ingrediente.carbs;
            document.getElementById('edit-gordura').value = ingrediente.fat;
            document.getElementById('edit-fibra').value = ingrediente.fiber;
        }

        function salvarEdicao() {
            if (!ingredienteEditando) return;

            const ingredientes = carregarIngredientes();
            const index = ingredientes.findIndex(i => i.id === ingredienteEditando.id);
            
            if (index !== -1) {
                ingredientes[index] = {
                    ...ingredienteEditando,
                    name: document.getElementById('edit-nome').value,
                    category: document.getElementById('edit-categoria').value,
                    calories: parseFloat(document.getElementById('edit-calorias').value) || 0,
                    protein: parseFloat(document.getElementById('edit-proteina').value) || 0,
                    carbs: parseFloat(document.getElementById('edit-carbs').value) || 0,
                    fat: parseFloat(document.getElementById('edit-gordura').value) || 0,
                    fiber: parseFloat(document.getElementById('edit-fibra').value) || 0
                };

                salvarIngredientes(ingredientes);
                renderizarTabela();
                fecharModalEdicao();
                mostrarNotificacao('‚úÖ Ingrediente atualizado com sucesso!', 'success');
            }
        }

        function fecharModalEdicao() {
            document.getElementById('modal-edicao').classList.add('hidden');
            ingredienteEditando = null;
        }

        // Modal de Exclus√£o
        let ingredienteExcluindo = null;

        function excluirIngrediente(id) {
            const ingredientes = carregarIngredientes();
            const ingrediente = ingredientes.find(i => i.id === id);
            
            if (ingrediente) {
                ingredienteExcluindo = ingrediente;
                document.getElementById('nome-ingrediente-excluir').textContent = ingrediente.name;
                document.getElementById('modal-exclusao').classList.remove('hidden');
            }
        }

        function confirmarExclusao() {
            if (!ingredienteExcluindo) return;

            const ingredientes = carregarIngredientes();
            const ingredientesFiltrados = ingredientes.filter(i => i.id !== ingredienteExcluindo.id);
            
            salvarIngredientes(ingredientesFiltrados);
            renderizarTabela();
            fecharModalExclusao();
            mostrarNotificacao('üóëÔ∏è Ingrediente exclu√≠do com sucesso!', 'success');
        }

        function fecharModalExclusao() {
            document.getElementById('modal-exclusao').classList.add('hidden');
            ingredienteExcluindo = null;
        }

        // Mostrar notifica√ß√£o
        function mostrarNotificacao(mensagem, tipo = 'info') {
            // Remover notifica√ß√£o anterior se existir
            const notificacaoAnterior = document.getElementById('notificacao');
            if (notificacaoAnterior) {
                notificacaoAnterior.remove();
            }
            
            // Criar nova notifica√ß√£o
            const notificacao = document.createElement('div');
            notificacao.id = 'notificacao';
            notificacao.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 max-w-sm ${
                tipo === 'success' ? 'bg-green-500 text-white' : 
                tipo === 'error' ? 'bg-red-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            notificacao.innerHTML = `
                <div class="flex items-center gap-2">
                    <span class="text-lg">${tipo === 'success' ? '‚úÖ' : tipo === 'error' ? '‚ùå' : '‚ÑπÔ∏è'}</span>
                    <span>${mensagem}</span>
                </div>
            `;
            
            document.body.appendChild(notificacao);
            
            // Remover ap√≥s 3 segundos
            setTimeout(() => {
                if (notificacao.parentNode) {
                    notificacao.remove();
                }
            }, 3000);
        }

        // Inicializar
        renderizarTabela();
    </script>

    <!-- Modal de Edi√ß√£o -->
    <div id="modal-edicao" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4">‚úèÔ∏è Editar Ingrediente</h3>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nome:</label>
                    <input type="text" id="edit-nome" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Categoria:</label>
                    <select id="edit-categoria" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                        <option value="Prote√≠na">Prote√≠na</option>
                        <option value="Carboidrato">Carboidrato</option>
                        <option value="Gordura">Gordura</option>
                        <option value="Fruta">Fruta</option>
                        <option value="Vegetal">Vegetal</option>
                        <option value="L√≠quido">L√≠quido</option>
                    </select>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Calorias:</label>
                        <input type="number" id="edit-calorias" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Prote√≠na (g):</label>
                        <input type="number" id="edit-proteina" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Carboidratos (g):</label>
                        <input type="number" id="edit-carbs" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Gordura (g):</label>
                        <input type="number" id="edit-gordura" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Fibra (g):</label>
                    <input type="number" id="edit-fibra" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                </div>
            </div>
            
            <div class="flex gap-3 mt-6">
                <button onclick="salvarEdicao()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 text-sm">
                    üíæ Salvar
                </button>
                <button onclick="fecharModalEdicao()" class="flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">
                    ‚ùå Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Exclus√£o -->
    <div id="modal-exclusao" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
            <h3 class="text-lg font-semibold mb-4 text-red-600">üóëÔ∏è Excluir Ingrediente</h3>
            
            <p class="text-gray-700 mb-6">
                Tem certeza que deseja excluir o ingrediente <strong id="nome-ingrediente-excluir"></strong>?
                <br><br>
                <span class="text-sm text-red-600">‚ö†Ô∏è Esta a√ß√£o n√£o pode ser desfeita!</span>
            </p>
            
            <div class="flex gap-3">
                <button onclick="confirmarExclusao()" class="flex-1 bg-red-600 text-white py-2 px-4 rounded-lg hover:bg-red-700 text-sm">
                    üóëÔ∏è Excluir
                </button>
                <button onclick="fecharModalExclusao()" class="flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 text-sm">
                    ‚ùå Cancelar
                </button>
            </div>
        </div>
    </div>
</body>
</html>
